---

Copyright 2013 Mentor Graphics Corp.  All Rights Reserved.
 
---

 
Display the port name instead of the interface name in the explorer view for a 
referenced component
### xtUML Project Analysis Note
 

1. Abstract
-----------
One customer believes it is much more useful to know the port of a component instead of the interface.  
If for example the component has multiple ports of he same interface, these can not be distinguished in the explorer view.  
This issue is rasied to resolve this problem in a way that is appropriate for all customers.
  

2. Document References
----------------------
[1] Git issue 138 - https://github.com/xtuml/internal/issues/138  
[2] CQ issue dts0100729739,  
    Display the port name instead of the interface name in the explorer view for a referenced component  
[3] \\\wv\dfs\bridgepoint\field_data\dts0100729739
    \me_component_multiple_ports_formalized.png,  
This is an image sent by a customer that shows why not displaying the port name can be confusing in the case of multiple ports formalized to the same interface.  
[4] CQ issue dts0101021818,  
Upgrade model compilers to consider the new element Port Reference
	
3. Background
-------------
3.1 Currently Bridge Point, in the a model explorer, shows a tree representation of the model, where  
    ports are represented as a tree node that is a child to the component tree node.
    When there's a component reference assigned to a component, there's a tree node 
    representing that reference, but expanding that reference shows the interface reference, of the 
    interface which, the referenced port is formalized to.
    
3.2 In case of having a component with multiple ports formalized to the same interface, and having 
    a component reference assigned to that component, the user might find it confusing while expanding
    the component reference instance in the tree view.
    There will show multiple interface references of the same name under the component reference  
    without showing their related ports names.
    There's an image to show this case in [3].  

4. Requirements
---------------
4.1 Display the port name along with the interface name in the explorer view for
    a referenced component

 
5. Analysis
-----------
5.1  There is a problem with the current way interface names are displayed in the 
     tree view.  The case where a component has multiple ports formalized to 
     the same interface looks bad, and is ambiguous (see [3]).

5.2 There are three ways to get this problem resolved:  
5.2.1 Make the port tree node show directly under the component reference
      in the ME tree view.  	
      The changes needed for this solution is one line change in the file 
      ui.explorer/sql/UITree.pei.sql.  
      This file will be modified to include the 
      port of the component definition as a child of the component 
      reference.  
      The hover text on the imported interface references will
      show the port name.  
      Since we have this workaround in the graphics this modification might be 
      enough.  
      The problem of this solution is that the port will now be showing in two places and modification will be allowed in both places.  
      We have the same issue with operations and signals that are used in interface references.  
      SAAB does not want to allow modification at that lower level, so we at least need to consider this.  
      The good thing about this solution is, it's a very limited change
      doesn't involve any meta-model modification.  It just involves how the 
      tree points to the port instance as opposed to 
	imported requirement/imported provision elements.  
	It only changes how it's displayed in the tree view.
	It is more comprehensible to the user, as they show the same way the ports 
	show under the referenced component.    
      The end result will look like the following:   
      ![alt tag](https://raw.github.com/xtuml/internal/master/doc-internal/notes/138_dts0100729739/portUnderCompRef.PNG?token=2733896__eyJzY29wZSI6IlJhd0Jsb2I6eHR1bWwvaW50ZXJuYWwvbWFzdGVyL2RvYy1pbnRlcm5hbC9ub3Rlcy8xMzhfZHRzMDEwMDcyOTczOS9wb3J0VW5kZXJDb21wUmVmLlBORyIsImV4cGlyZXMiOjEzODk2MzM0Mzh9--ae55a958b9f939719df570b25d9f23a81b400780)	  							 
  
  
5.2.2 Modify the tree node of the imported requirement/imported provision 
      that shows under the component reference, to show the port name along with 
	  the interface name.  
	  The changes needed for this solution is adding an if statement to the 
	  ui.explorer/arc/create_label_provider.inc file.   
	  Consequently the method getText() will return a different result in 
	  case of imported requirement/imported provision elements.  
	  The result will be in the form portName::InterfaceName    
	  Displaying the portName will be optional, it will be controlled by
	  a preference that defaults to true.  
	  If that preference is set to false the port name will not show.  
          The end result will look like the following:   
	  ![alt tag]( https://raw.github.com/xtuml/internal/master/doc-internal/notes/138_dts0100729739/PortNameAlongWithIfaceName.PNG?token=2733896__eyJzY29wZSI6IlJhd0Jsb2I6eHR1bWwvaW50ZXJuYWwvbWFzdGVyL2RvYy1pbnRlcm5hbC9ub3Rlcy8xMzhfZHRzMDEwMDcyOTczOS9Qb3J0TmFtZUFsb25nV2l0aElmYWNlTmFtZS5QTkciLCJleHBpcmVzIjoxMzg5NjMzNDQyfQ%3D%3D--222a47be449447334878c9a28187b923592af5e3)
  
5.2.3 Introduce new model element Port Reference. This is a new class, with new 
      data for explorer, properties and probably ui.text.
      This new element will capture all the needed informations and would  
      serve as a child for the component reference the same way Port is a child
      to component. 	  
      It will have a representation in the model explorer view as a tree node 
      that is a child to the component reference node.  
      This class is named "Port Reference", It has class letters "CL_POR".    
      This class has a derived attribute "Name" that displays the 
      name of the referenced port.  
      This element is present only when a component reference is assigned   
      to a component,hence there is no graphical representation to the 
      element.  
      The element in not allowed to be created manually neither by using the palette, 
      right click on canvas nor from the tree view.  
      There will never be a case where the model will have a CL_POR that is not formalized, therfore the name used in the case when there is no associated port is an empty string.  
      This change needs a multi-file modifications plus all of the maintenance OAL for 
      needed for setting up the instances and disposing them.  
      The final look of this solution will be the same as the one presented in 
      [5.2.1], without the ability to modify the component port in multiple 
      places.  
	  
5.3 The Proposed solution is the one explained in 5.2.3   
    The work required for this solution is detailed below in section[6]    	

6. Work Required
----------------
6.1 Add a new class to the meta model to represent the port reference 
    This class is named "Port Reference", It has class letters "CL_POR"  
    This class has a derived attribute "Name" that displays the 
    name of the referenced port.  

6.2 Upgrade parser traversals to use port reference where needed    

6.3 Touch the verifier in limited places to use the new traversal.
    All places that use the relation R4700 between Componenet Reference and Imported Reference gets 
    updated with the new relations.  
    
6.4 Upgrade the io.mdl plugin to adjust the import and export to consider the new element. 
    So that the newly created models containing instances of port references gets properly exported
and imported.  

6.5 Create upgrade functionality to upgrade old models that doesn't have this elemnt present.  
The new elemnt will be added automatically wherever it is needed.  
Each occurence of a component reference assigned to acomponent with ports
will git the corresponding Port Reference elements created.  

6.6 Upgrade model compare feature to count for the new element.  

6.7 Update context menu entries for the new element.  
Even that there will be no graphical representation for the Port Reference, it is still present in the tree view and can be right clicked.  

6.8 Upgrade model compilers to consider the new element if needed.   
    A separate issue will be raised to address this part[4].  
 

7. Acceptance Test
------------------
7.1 Make sure all the existing JUnit tests pass  
7.2 Manual test:  


    _- Open GPS project  
    _- Navigate to "system" package  
    _- In the ME expand component reference "GPS Watch::Library::UI"  
    R_ Under the component reference shows "UI" port name  
    _- Expand "UI" port    
    R_ The interface name "UI" shows directly under the port  
7.3 Add new JUnit test to test the appearance of the "Port Refernce" in the tree view  
7.4 Add new JUnit to test the model upgrade functionality for the old models make sure they don't get corrupted  
7.5 Modify the existing io.mdl tests to count for the new elemnt added  
 
End
---
