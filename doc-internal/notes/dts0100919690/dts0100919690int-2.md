---

Copyright 2013 Mentor Graphics Corp.  All Rights Reserved.

---

# Port MC-Java to internal BridgePoint parser - Phase 2 New Build process.
### xtUML Project Design Note

1. Abstract
-----------
The xtUML Editor in BridgePoint is going open source.  We need to split the
source code so that Verifier and perhaps other parts can remain closed source.
This note covers the reconfiguration of the build infrastructure to use the
previously promoted Java Pre-builder[4]. It also covers the needed changes to
MC-Java to traverse the modern OAL subsystem meta-model. (Up until this point,
MC-Java was using a hand maintained schema for the OAL subsystems that has
incompatible association numbers).

2. Document References
----------------------
[1] ClearQuest DEI dts0100919690 - Separate the open source code from the closed source code.
[2] Issues 2, https://github.com/xtuml/doc/issues/35
[3] doc-internal/notes/dts0100919690/dts0100919690dnt-2.md
[4] internal/doc-internal/notes/dts0100919690/dts0100919690int-1.md

3. Background
-------------
See [3].

4. Requirements
---------------
See [3].

5. Work Required
----------------
See [3].

6. Implementation Comments
--------------------------
Six unexpected test failures were noted the Parse All suite. A final single
quote was missing from an error message. This was found to be because of
defective single quote escaping behavior, such that strings ending in a single
quote had the quote truncated. The fix was to add a period to the end of the
message so that the erroneous truncation does not happen. An issue [5] is
raised to track the fix for the single quote handling itself.

A large number of unexpected test failures were experienced in IO Mdl test
suites. These were traced to upgrade code in ImportModelStream. At the end of
the load process, we perform upgrade tasks on a collection called
'loadedGraphicsInstances'. Because pre-builder emits model elements in a
different order than the previous export method, the calls which populate this
collection are generated in a different order. Hence the upgrades are performed
in a different order leading to UUID's being allocated in a different pattern.
The conclusion was that it is safe to replace the expected result files.

When rolled out to other build environments, poor build performance was
observed. Accordingly, the Pre-builder and the generate.xml ant script were
modified to permit the build to be performed in four passes as opposed to two
previously. The reduced instance extent size reduced the build time to below
that seen with the current build process.

During the discussion on build performance, a request was made to eliminate the
'Variable Location' instances from the export data. This led to a further three
test failures which were shown to differ only by the existence of those
elements. Once again, it is deemed safe to replace these expected test results.

7. Unit Test
------------
All J-Units must pass. However, there is one known failure in Debug Suite I
which is due to be fixed with Job #135.

8. Code Changes
---------------
Branch name: 35_dts0100919690-3


End
---
